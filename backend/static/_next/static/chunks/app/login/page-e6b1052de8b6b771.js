(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{31886:(e,t,a)=>{"use strict";a.d(t,{Ev:()=>l,FH:()=>n,TZ:()=>c,XU:()=>o,ZQ:()=>i,uZ:()=>d});var s=a(23464);let r=a(49509).env.NEXT_PUBLIC_API_URL||window.location.origin;console.log("API_BASE_URL:",r);let n=s.A.create({baseURL:"".concat(r,"/api/v1"),headers:{"Content-Type":"application/json"},timeout:1e4});n.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!s._retry){s._retry=!0;try{let e=localStorage.getItem("refresh_token");if(e){let{access_token:t}=(await n.post("/auth/refresh",{refresh_token:e})).data;return localStorage.setItem("access_token",t),s.headers.Authorization="Bearer ".concat(t),n(s)}}catch(e){console.log("Token refresh failed:",e),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),a.e(671).then(a.bind(a,56671)).then(e=>{let{toast:t}=e;t.error("Your session has expired. Please log in again.")}),window.location.pathname.includes("/login")||setTimeout(()=>{window.location.href="/login"},1e3)}}return Promise.reject(e)});let i={login:async(e,t)=>{try{console.log("Attempting login with:",{email:e,baseURL:n.defaults.baseURL});let a=await n.post("/auth/login",{email:e,password:t});return console.log("Login response:",a.status,a.data),a.data}catch(e){var a,s;throw console.error("Login error details:",{message:e.message,status:null==(a=e.response)?void 0:a.status,data:null==(s=e.response)?void 0:s.data,config:e.config}),e}},register:async e=>{try{console.log("Attempting register with:",{...e,password:"[HIDDEN]",baseURL:n.defaults.baseURL});let t=await n.post("/auth/register",e);return console.log("Register response:",t.status,t.data),t.data}catch(e){var t,a;throw console.error("Register error details:",{message:e.message,status:null==(t=e.response)?void 0:t.status,data:null==(a=e.response)?void 0:a.data,config:e.config}),e}},getOrganizations:async()=>(await n.get("/auth/organizations")).data,getPendingMemberships:async()=>(await n.get("/auth/pending-memberships")).data,approveMembership:async(e,t,a)=>(await n.post("/auth/approve-membership",{membership_id:e,action:t,role:a})).data,getCurrentUser:async()=>(await n.get("/auth/me")).data,logout:async()=>{await n.post("/auth/logout"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}},o={getAll:async()=>(await n.get("/services/")).data,create:async e=>(await n.post("/services/",e)).data,update:async(e,t)=>(await n.put("/services/".concat(e),t)).data,updateStatus:async(e,t,a)=>(await n.patch("/services/".concat(e,"/status"),{status:t,reason:a})).data,delete:async e=>{await n.delete("/services/".concat(e))},getHistory:async e=>(await n.get("/services/".concat(e,"/history"))).data},l={getAll:async()=>(await n.get("/incidents/")).data,create:async e=>(await n.post("/incidents/",e)).data,update:async(e,t)=>(await n.put("/incidents/".concat(e),t)).data,addUpdate:async(e,t)=>(await n.post("/incidents/".concat(e,"/updates"),t)).data,delete:async e=>{await n.delete("/incidents/".concat(e))}},c={getPublicStatus:async e=>(await s.A.get("".concat(r,"/api/v1/status/").concat(e))).data,getStatusHistory:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return(await s.A.get("".concat(r,"/api/v1/status/").concat(e,"/history?days=").concat(t))).data},getPublicIncidents:async e=>(await s.A.get("".concat(r,"/api/v1/status/").concat(e,"/incidents"))).data},d={getUptimeMetrics:async e=>(await n.get("/metrics/uptime/".concat(e))).data}},35695:(e,t,a)=>{"use strict";var s=a(18999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},40571:(e,t,a)=>{Promise.resolve().then(a.bind(a,78007))},40968:(e,t,a)=>{"use strict";a.d(t,{b:()=>o});var s=a(12115),r=a(63655),n=a(95155),i=s.forwardRef((e,t)=>(0,n.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var o=i},49026:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>l});var s=a(95155);a(12115);var r=a(74466),n=a(53999);let i=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:a}),t),...r})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}},51154:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(52596),r=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},63655:(e,t,a)=>{"use strict";a.d(t,{hO:()=>l,sG:()=>o});var s=a(12115),r=a(47650),n=a(99708),i=a(95155),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,n.TL)(`Primitive.${t}`),r=s.forwardRef((e,s)=>{let{asChild:r,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(r?a:t,{...n,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function l(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},76052:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,AuthProvider:()=>l,O:()=>d});var s=a(95155),r=a(12115),n=a(31886),i=a(56671);let o=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{localStorage.getItem("access_token")?g():u(!1)},[]);let g=async()=>{try{let e=await n.ZQ.getCurrentUser();c(e)}catch(t){var e;console.log("Failed to load user, clearing tokens:",null==(e=t.response)?void 0:e.status),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),c(null),"/login"!==window.location.pathname&&"/register"!==window.location.pathname&&Promise.resolve().then(a.bind(a,56671)).then(e=>{let{toast:t}=e;t.error("Your session has expired. Please log in again.")})}finally{u(!1)}},m=async(e,t)=>{try{let a=await n.ZQ.login(e,t);if(a.can_login)localStorage.setItem("access_token",a.access_token),localStorage.setItem("refresh_token",a.refresh_token),c(a.user),i.toast.success("Successfully logged in!");else throw"pending"===a.membership_status?i.toast.error(a.message||"Your membership is pending approval"):"denied"===a.membership_status&&i.toast.error(a.message||"Your membership request was denied"),Error(a.message||"Cannot login at this time")}catch(t){var a,s;let e=(null==(s=t.response)||null==(a=s.data)?void 0:a.detail)||t.message||"Login failed";throw i.toast.error(e),t}},p=async e=>{try{let t=await n.ZQ.register(e);return t.can_login?(localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token),c(t.user),i.toast.success(t.message||"Registration successful!")):i.toast.success(t.message||"Registration submitted for approval"),t}catch(s){var t,a;let e=(null==(a=s.response)||null==(t=a.data)?void 0:t.detail)||"Registration failed";throw i.toast.error(e),s}},h=async()=>{try{await n.ZQ.logout()}catch(e){}finally{c(null),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),i.toast.success("Logged out successfully")}};return(0,s.jsx)(o.Provider,{value:{user:l,loading:d,login:m,register:p,logout:h},children:t})}function c(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(e){let{children:t}=e,{user:a,loading:r}=c();return r?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):a?(0,s.jsx)(s.Fragment,{children:t}):(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Authentication Required"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please log in to access this page."}),(0,s.jsx)("a",{href:"/login",className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",children:"Go to Login"})]})})}},78007:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(95155),r=a(12115),n=a(35695),i=a(6874),o=a.n(i),l=a(97168),c=a(89852),d=a(82714),u=a(88482),g=a(49026),m=a(76052),p=a(51154);function h(){let[e,t]=(0,r.useState)(""),[a,i]=(0,r.useState)(""),[h,v]=(0,r.useState)(!1),[f,x]=(0,r.useState)(""),{login:b}=(0,m.A)(),y=(0,n.useRouter)(),w=async t=>{t.preventDefault(),v(!0),x("");try{await b(e,a),y.push("/dashboard")}catch(e){x("Invalid email or password")}finally{v(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)(u.Zp,{className:"w-full max-w-md",children:[(0,s.jsxs)(u.aR,{className:"space-y-1",children:[(0,s.jsx)(u.ZB,{className:"text-2xl font-bold text-center",children:"Sign In"}),(0,s.jsx)(u.BT,{className:"text-center",children:"Enter your credentials to access your status page dashboard"})]}),(0,s.jsxs)(u.Wu,{children:[(0,s.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[f&&(0,s.jsx)(g.Fc,{variant:"destructive",children:(0,s.jsx)(g.TN,{children:f})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"email",children:"Email"}),(0,s.jsx)(c.p,{id:"email",type:"email",placeholder:"admin@example.com",value:e,onChange:e=>t(e.target.value),required:!0,disabled:h})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"password",children:"Password"}),(0,s.jsx)(c.p,{id:"password",type:"password",placeholder:"Enter your password",value:a,onChange:e=>i(e.target.value),required:!0,disabled:h})]}),(0,s.jsxs)(l.$,{type:"submit",className:"w-full",disabled:h,children:[h&&(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign In"]})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",(0,s.jsx)(o(),{href:"/register",className:"text-primary hover:underline",children:"Sign up"})]})}),(0,s.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Demo Credentials:"}),(0,s.jsxs)("p",{className:"text-xs text-blue-700",children:["Email: admin@example.com",(0,s.jsx)("br",{}),"Password: password123"]})]})]})]})})}},82714:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var s=a(95155);a(12115);var r=a(40968),n=a(53999);function i(e){let{className:t,...a}=e;return(0,s.jsx)(r.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},88482:(e,t,a)=>{"use strict";a.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>i});var s=a(95155);a(12115);var r=a(53999);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...a})}},89852:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(95155);a(12115);var r=a(53999);function n(e){let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},97168:(e,t,a)=>{"use strict";a.d(t,{$:()=>l,r:()=>o});var s=a(95155);a(12115);var r=a(99708),n=a(74466),i=a(53999);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:a,size:n,asChild:l=!1,...c}=e,d=l?r.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:(0,i.cn)(o({variant:a,size:n,className:t})),...c})}}},e=>{e.O(0,[464,671,455,874,441,964,358],()=>e(e.s=40571)),_N_E=e.O()}]);